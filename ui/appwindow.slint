import { Button, VerticalBox, LineEdit, ComboBox } from "std-widgets.slint";

export component AppWindow inherits Window {
    title: "11th Echo Settings";
    icon: @image-url("../eleventhecho.ico");
    min-width: 400px;
    min-height: 300px;
    background: #1e1e2e; // Catppuccin Mocha base (Dark Theme)

    out property <string> api-key-text: api-key-input.text;

    callback start-recording(string);
    callback stop-recording();
    in property <bool> is-recording: false;
    in property <float> audio-level: 0.0;

    VerticalBox {
        padding: 20px;
        spacing: 15px;

        Text {
            text: "11th Echo";
            font-size: 24px;
            font-weight: 700;
            color: #cdd6f4;
            horizontal-alignment: center;
        }

        // Audio Level Indicator
        Rectangle {
            height: 4px;
            background: #313244;
            border-radius: 2px;
            Rectangle {
                x: 0;
                width: parent.width * root.audio-level;
                background: root.is-recording ? #a6e3a1 : #6c7086;
                border-radius: 2px;
                animate width { duration: 50ms; }
            }
        }

        Text {
            text: "Status: " + (root.is-recording ? "Listening..." : "Idle");
            color: root.is-recording ? #a6e3a1 : #6c7086; // Green or Overlay2
            horizontal-alignment: center;
        }

        VerticalBox {
            spacing: 5px;
            Text { text: "ElevenLabs API Key:"; color: #bac2de; }
            api-key-input := LineEdit {
                placeholder-text: "sk_...";
                input-type: password;
            }
        }

        VerticalBox {
            spacing: 5px;
            Text { text: "Microphone:"; color: #bac2de; }
            ComboBox {
                model: ["Default Device", "Microphone 2"];
                current-value: "Default Device";
            }
        }

        Button {
            text: root.is-recording ? "Stop Recording (Ctrl+Space)" : "Start Recording (Ctrl+Space)";
            primary: true;
            height: 40px;
            clicked => {
                if (root.is-recording) {
                    root.stop-recording();
                } else {
                    root.start-recording(api-key-input.text);
                }
            }
        }
    }
}
